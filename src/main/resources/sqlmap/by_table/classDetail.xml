<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd"><sqlMap namespace="ren.sing.dao.table">	<insert id="class_detail_insert" parameterClass="java.util.HashMap">		<![CDATA[			INSERT INTO CLASS_DETAIL (				class_detail_id,				class_master_id,				student_id,				teacher_id,				song,				date,				time,				ranges,				s_time,				e_time,				hw,				teacher_note,				student_note,				type,				finish,				sign,				detail_status,				updater,				update_time				) VALUES (				#class_detail_id#,				#class_master_id#,				#student_id#,				#teacher_id#,				#song#,				#date#,				#time#,				#ranges#,				#s_time#,				#e_time#,				#hw#,				#teacher_note#,				#student_note#,				#type#,				#finish#,				#sign#,				#detail_status#,				#updater#,				#update_time#			)		]]>	</insert>	<select id="class_detail_query" resultClass="java.util.HashMap" parameterClass="java.util.HashMap">		<![CDATA[			SELECT class_detail_id,class_master_id,				   (SELECT name FROM class_master WHERE class_master_id=class_master_id) as class_name,				   student_id,teacher_id,				   (SELECT name FROM person WHERE person_id=student_id) as student_name,				   (SELECT name FROM person WHERE person_id=teacher_id) as teacher_name,				   song,type,date,				   time,				   (SELECT interval_time FROM courses_time WHERE id=time) as interval_time,				   ranges,s_time,e_time,hw,teacher_note,student_note,type,finish,sign,detail_status,updater,update_time			FROM CLASS_DETAIL		]]>		<dynamic prepend="WHERE">			<isNotEmpty prepend="AND" property="class_detail_id">				<![CDATA[ class_detail_id = #class_detail_id#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="class_master_id">				<![CDATA[ class_master_id = #class_master_id#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="student_id">				<![CDATA[ student_id = #student_id#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="teacher_id">				<![CDATA[ teacher_id = #teacher_id#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="song">				<![CDATA[ song = #song#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="date">				<![CDATA[ date = #date#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="time">				<![CDATA[ time = #time#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="ranges">				<![CDATA[ ranges = #ranges#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="s_time">				<![CDATA[ s_time = #s_time#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="e_time">				<![CDATA[ e_time = #e_time#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="hw">				<![CDATA[ hw = #hw#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="teacher_note">				<![CDATA[ teacher_note = #teacher_note#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="student_note">				<![CDATA[ student_note = #student_note#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="student_note">				<![CDATA[ student_note = #student_note#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="student_note">				<![CDATA[ student_note = #student_note#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="type">				<![CDATA[ type = #type#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="finish">				<![CDATA[ finish = #finish#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="sign">				<![CDATA[ sign = #sign#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="detail_status">				<![CDATA[ detail_status = #detail_status#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="updater">				<![CDATA[ updater = #updater#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="update_time">				<![CDATA[ update_time = #update_time#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="today">				<![CDATA[ date >= #today#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="now_time">				<![CDATA[ time > #now_time#  ]]>			</isNotEmpty>						<isNotEmpty prepend="AND" property="date_pre">				<![CDATA[( date like #date_pre# 					   or  date like #date_now# 					   or  date like #date_next# )				]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="date_between_start">				<![CDATA[ date between #date_between_start# and #date_between_end# ]]>			</isNotEmpty>		</dynamic>		<isNotEmpty property="order">			<![CDATA[	ORDER BY $order$	]]>		</isNotEmpty>		<isNotEmpty prepend="LIMIT" property="rowLimit">			<isNotEmpty property="fromIndex">				<![CDATA[ $fromIndex$, $rowLimit$ ]]>			</isNotEmpty>			<isEmpty property="fromIndex">				<![CDATA[ $rowLimit$ ]]>			</isEmpty>		</isNotEmpty>	<!--  	<include refid="limit_offset" /> -->	</select>		<select id="class_detail_query_count" resultClass="java.util.HashMap" parameterClass="java.util.HashMap">		<![CDATA[			SELECT count(*) count			FROM CLASS_DETAIL		]]>	</select>	<update id="class_detail_update" parameterClass="java.util.HashMap">		<![CDATA[			UPDATE CLASS_DETAIL		]]>		<dynamic prepend="SET">			<isNotEmpty prepend="," property="class_detail_id">				<![CDATA[ class_detail_id = #class_detail_id#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="class_master_id">				<![CDATA[ class_master_id = #class_master_id#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="student_id">				<![CDATA[ student_id = #student_id#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="teacher_id">				<![CDATA[ teacher_id = #teacher_id#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="song">				<![CDATA[ song = #song#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="date">				<![CDATA[ date = #date#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="time">				<![CDATA[ time = #time#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="ranges">				<![CDATA[ ranges = #ranges#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="s_time">				<![CDATA[ s_time = #s_time#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="e_time">				<![CDATA[ e_time = #e_time#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="hw">				<![CDATA[ hw = #hw#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="teacher_note">				<![CDATA[ teacher_note = #teacher_note#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="student_note">				<![CDATA[ student_note = #student_note#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="type">				<![CDATA[ type = #type#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="finish">				<![CDATA[ finish = #finish#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="sign">				<![CDATA[ sign = #sign#  ]]>			</isNotEmpty>			<isNotEmpty prepend="AND" property="detail_status">				<![CDATA[ detail_status = #detail_status#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="updater">				<![CDATA[ updater = #updater#  ]]>			</isNotEmpty>			<isNotEmpty prepend="," property="update_time">				<![CDATA[ update_time = #update_time#  ]]>			</isNotEmpty>		</dynamic>		<![CDATA[			WHERE				class_detail_id = #class_detail_id#		]]>	</update>		<update id="class_detail_update_sign" parameterClass="java.util.HashMap">		<![CDATA[			UPDATE CLASS_DETAIL		]]>		<dynamic prepend="SET">			<isNotEmpty prepend="," property="sign">				<![CDATA[ sign = #sign#  ]]>			</isNotEmpty>		</dynamic>		<![CDATA[			WHERE date = #date#			AND   time = #time#		]]>	</update>	<delete id="class_detail_delete" parameterClass="java.util.HashMap">		<![CDATA[			DELETE FROM CLASS_DETAIL WHERE class_detail_id = #class_detail_id#		]]>	</delete>	<insert id="class_detail_upsert" parameterClass="java.util.HashMap">		<![CDATA[			INSERT INTO CLASS_DETAIL (				class_master_id,				student_id,				teacher_id,				type,				date,				time,				ranges				) VALUES (				#class_master_id#,				#student_id#,				#teacher_id#,				#type#,				#date#,				#time#,				#ranges#			)			ON DUPLICATE KEY UPDATE				date = #date#,				time = #time#		]]>	</insert></sqlMap>